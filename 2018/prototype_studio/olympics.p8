pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
--whitewater
--by marcus zaeyen

function _init()
	--set color transparancies
	palt(0,false)
	palt(12,true)
end

function _update60()
		p:update(1)
end

function _draw()
	cls(12)
	map(0,0,0,-128,41,16)
	map(0,0,0,0,41,16)
	map(0,0,0,128,41,16)
	cam.x = lerp(cam.x,p.x,.1)
	cam.y = lerp(cam.y,p.y,.1)
	camera(flr(cam.x-56),
		flr(cam.y-48))
	p:draw()
end
-->8
--util

function lerp(a,b,t)
	return a + t*(b-a)
end
-->8
--object definitions

cam={x=184,y=64}

p= {
	x=184,
	y=0,
	dx=0,
	dy=0,
	xspeed=.2,
	yspeed=.05,
	xmax=5,
	ymax=2,
	update=function(self,current)
		--input
		if btn(➡️) then
			self.dx+=self.xspeed
		elseif btn(⬅️) then
			self.dx-=self.xspeed
		else
			if self.dx>0 then
				self.dx=max(self.dx-self.xspeed,0)
			elseif self.dx<0 then
				self.dx=min(self.dx+self.xspeed,0)
			end
		end
		if btn(⬆️) then
			self.dy-=self.yspeed
		elseif btn(⬇️) then
			self.dy+=self.yspeed
		else
			if self.dy>0 then
				self.dy=max(self.dy-self.yspeed,0)
			elseif self.dy<0 then
				self.dy=min(self.dy+self.yspeed,0)
			end
		end
		
		if self.dx>0 and self.dx>self.xmax then
			self.dx=self.xmax
		elseif self.dx<0 and self.dx<-self.xmax then
			self.dx=-self.xmax
		end
		
		if self.dy>0 and self.dy>self.ymax then
			self.dy=self.ymax
		elseif self.dy<0 and self.dy<-self.ymax then
			self.dy=-self.ymax
		end
		
		--current vector
		self.y += current
		
		--add d vector to pos
		self.x+=self.dx
		self.y+=self.dy
		
		--loop back around to top of map
		while self.y>=128 do
			self.y-=128
			cam.y-=128
		end
		while self.y<=0 do
			self.y+=128
			cam.y+=128
		end
	end,
	
	draw=function(self)
		if self.dy<1 then
			spr(7,self.x,self.y,2,2)
		elseif self.dx>0 then
			spr(3,self.x,self.y,2,2)
		elseif self.dx<0 then
			spr(9,self.x,self.y,2,2)
		else
			spr(1,self.x,self.y,2,2)
		end
	end
}
__gfx__
00000000ccccccc87cccccccccccccccccccccccccccccc87cccccccccccccc87ccccccccccccccccccccccc0000000000000000000000000000000000000000
00000000cccccc788dcccccccccccccccccccccccccccc788dcccccccccccc788dcccccccccccccccccccccc0000000000000000000000000000000000000000
00700700ccccc99d87ccccccccccccccccccccccccccc99d87ccccccccccc99d87cccccccccccccccccccccc0000000000000000000000000000000000000000
00077000cccc99f111cccccccccccccccc9ccccccccc991111cccccccccc994111ccccccccccc9cccccccccc0000000000000000000000000000000000000000
00077000ccc9970ff17ccccccccccccccc99ccccccc9975ff17cccccccc99704417ccccccccc99cccccccccc0000000000000000000000000000000000000000
00700700cc99f111117ccccccccc88f77884cccccc991111117ccccccc994111117ccccccccc48877f88cccc0000000000000000000000000000000000000000
00000000ccccc701107ccccccd77ff97744977dcccccc751157cccccccccc701107ccccccd77944779ff77dc0000000000000000000000000000000000000000
00000000ccccc778d99ccccc788811fdd1148887ccccc778d99cccccccccc778d99ccccc7888411ddf1188870000000000000000000000000000000000000000
3333ccccccccc7111499cccc88dd1198811ddd88ccccc7111199ccccccccc7111f99cccc88ddd1188911dd880000000000000000000000000000000000000000
3333ccccccccc71440799cccc77777977777777cccccc71445799cccccccc71ff0799cccc77777777977777c0000000000000000000000000000000000000000
3333ccccccccc711111499cccccc77977777ccccccccc711111199ccccccc711111f99cccccc77777977cccc0000000000000000000000000000000000000000
3333ccccccccc701107ccccccccccc9cccccccccccccc751157cccccccccc701107cccccccccccccc9cccccc0000000000000000000000000000000000000000
3333cccccccccc7d87cccccccccccc9ccccccccccccccc7d87cccccccccccc7d87ccccccccccccccc9cccccc0000000000000000000000000000000000000000
3333cccccccccc7d87cccccccccccccccccccccccccccc7d87cccccccccccc7d87cccccccccccccccccccccc0000000000000000000000000000000000000000
3333cccccccccc788dcccccccccccccccccccccccccccc788dcccccccccccc788dcccccccccccccccccccccc0000000000000000000000000000000000000000
3333ccccccccccc87cccccccccccccccccccccccccccccc87cccccccccccccc87ccccccccccccccccccccccc0000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cccc3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3b333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333b33000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33b33333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
333333b3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3b333333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333b33000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
333b3333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3333333b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303010000000000000000000000000000020303030303030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
