pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
 music()
end
cols={0,1,2,8,9,10,15,7}
function _draw()
 --position of playhead on ch0
 local beat=stat(20)
 --which pattern is playing
 --on 3 channels
 local patts={stat(16),stat(17),
 stat(18)}

 cls()
 --vol of current note
 local vols={}
 for i=1,#patts do
  local note=
 	get_note(patts[i],beat)
  local vol=band(note[2],0b00001110)
	 vol=shr(vol,1)
	 local pitch=band(note[1],0b00111111)
	 fillp(pitch+64*(pitch+1)+128*pitch)
	 rectfill(0,(i-1)*42,128,i*42,cols[vol])
	end	
end

function get_note(sfx, time)
  local addr = 0x3200 + 68*sfx + 2*time
  return { peek(addr) , peek(addr + 1) }
end

__map__
0000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011200000c2720c2550c27511040182750c27511040110400c2720c2551104011040182750c27511040182750c2750f0400c2750f040182750c2750f0400f0400c2720c2550f0400f0400a2710a2550e0400e040
011200000827208255082550c04014255082550c0400c04008272082550c0400c04014255082550825514255052550c040052550c04011255052550c0400c04005272052550c0400c04011255052550525511255
011200000021000211002110c21000211002110c210000000021000211002110c21000211002110c2100c2000022000221002250c22000221002210c2250c2000f2340f2310f2310f23511234112311123111235
011200000021000211002110c21000211002110c210000000021000211002110c21000211002110c2100c2000021000211002110c21000211002110c210000000021000211002110c21000211002110c2100c200
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011200000c173000000c17300000296750c17300000296050c173000000c17300000296750c1730c143296750c173000000c17300000296750c17300000000000c173000000c17300000296750c1732964500000
011200000c173306250c17300000296750c17300000296050c173000000c17329644296450c1730c143296750c173306750c17300000296750c17300000306750c173000000c1730000029675296540c17329655
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011200001475214752147521475214752147521475214752147521475214752147521471114702147021470213772137721377213772137721377213772137721377213772137721377213712137021370213701
0112000016772167221675216752167521675216752167521674216742167321672216712167021670216702157721572215752157521b7521b7521b7521575215742157421b73215742274310f4012447100401
0112000014772147221475214752147521b7521b752147511b7521b75214732147221b752147021a75214701137721872213752187521b7521b7521375213751137421b7421b7321372213712034410000000000
0112000016772167221675216752167521675216752167521674216742167321672216712167021670216702157721572215752157521575215752157521575215742157421573215722157120f4012440100401
011200001475218752147521875214752187521475218752147521875214752187521471114702147021470213772187721377218772137721877213772187721377218772137721877213712137021370213701
01120000167721b722167521b752167521b752167521b752167421b742167321b72216712167021670216702157721b722157521b752157521b752157521b752157421b742157321b72215712000000000000000
__music__
00 0d145e44
00 0c156144
01 0a141e44
00 0b142144
00 0a142044
00 0b151f44
00 0a142244
00 0b142344
00 0a142044
02 0b151f44

