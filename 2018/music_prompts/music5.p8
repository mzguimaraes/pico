pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
 music()
end
cols={0,1,2,8,9,10,15,7}
function _draw()
 --position of playhead on ch0
 local beat=stat(20)
 --which pattern is playing
 --on 3 channels
 local patts={stat(16),stat(17),
 stat(18)}

 cls()
 --vol of current note
 local vols={}
 for i=1,#patts do
  local note=
 	get_note(patts[i],beat)
  local vol=band(note[2],0b00001110)
	 vol=shr(vol,1)
	 local pitch=band(note[1],0b00111111)
	 fillp(pitch+64*(pitch+1)+128*pitch)
	 rectfill(0,(i-1)*42,128,i*42,cols[vol])
	end	
end

function get_note(sfx, time)
  local addr = 0x3200 + 68*sfx + 2*time
  return { peek(addr) , peek(addr + 1) }
end

__sfx__
011000001df55000001df551df55000001df551df55000001df551df55000001df551df55000001df55000001df55000001df551df55000001df551df55000001df551df55000001df551df55000001df5500000
0110000000100001000015000150071500515007150051500c1500c1500c150071500715007150071500715000100001000015000150071500515007150051500c1500c1500c1500715007150051501115011150
001000000c17318d1518c35000000de7518d1518c3518d150c1730cd150cc35000000de7518d1518c35000000c1730cd150cc3518d150de7518d1518c35000000c1730cd150cc35000000de7518d1518c3500000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011000000d0640d0610d0610d065000000000000000000000d0640d0610d0610d065000000000000000000000d0640d0610d0610d065000000000000000000000d0640d0610d0610d06500000000000000000000
011000000906409061090610906500000000000000000000090640906109061090650000000000000000000009064090610906109065000000000000000000000906409061090610906500000000000000000000
011000001006410061100611006500000000000000000000100641006110061100650000000000000000000010064100611006110065000000000000000000001006410061100611006500000000000000000000
011000000b0640b0610b0610b065000000000000000000000b0640b0610b0610b065000000000000000000000b0640b0610b0610b065000000000000000000000b0640b0610b0610b06500000000000000000000
011000001005614016170261c0461005614016170261c0461005614016170261c0461005614016170261c0461004614016170461c0161004614016170261c0161005614036170261c0161005614036170261c016
011000000d0561001612026190460d0561001612026190460d0561001612026190460d0561001612026190460d0461001612046190160d0461001612026190160d0561003612026190160d056100361202619016
011000001405615016170261004614056150161702610046140561501617026100461405615016170261004614046150161704610016140461501617046100161405615036170261001614056150361702610016
011000000f05610016120260b0460f05610016120260b0460f05610016120260b0460f05610016120260b0460f04610016120460b0160f04610016120460b0160f05610036120260b0160f05610036120260b016
011000000d0640d0610d0610d065287652871500000287150d0640d0610d0610d065000000000000000000000d0640d0610d0610d065000000000000000000000d0640d0610d0610d06519765197152876528715
011000000906409061090610906525765257152570525715090640906109061090650000000000000000000009064090610906109065257652571525765257150906409061090610906521765217152576525715
0110000010064100611006110065257652571523765237151006410061100611006525765257152376523715100641006110061100652c7652871528765287151006410061100611006528715000000000000000
011000000b0640b0610b0610b065257652571523765237150b0640b0610b0610b0652c7652c71528765287150b0640b0610b0610b0652c7652c7152a7652a7150b0640b0610b0610b0652a7652a7152776527715
011000000d32318303183031861418635003030d3230030300303003030d32300303186350030300303003030d323003030d3031861418635003030d3230030300303003030d3230030318635003030d32300303
0108002018635000003060500000000000c6151161511625186350000000000000000000000000116151162518635000000000000000000000c6151161511625186350000024605246050c6150c6151c6251c635
011000200c635000000c635000000c61424615306052960030605000000000000000306050000030605000000d32300000306050d32330635000000d32330635306050d323306353060530635000003063500000
011000000d3232c7412c74518614186352c7450d3232f7452f305003032d745003032b6352c7452c7412a7410d32328305287451861418635287450d3232830525745003030d3230030323745000001863500000
011000000d32321741217451861418635217450d323287451c3051c3051c745003032b6351974528741003030d323283052174518614186352174515741217452d745003030d323003032c7402a7411863500000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
011000000d32328741287451861418635287450d3232a7452f3050030328745003032b6352c7452c7412a7410d323283052a74518614186352c7450d323283052f745003030d3230030334745000001863500000
011000000d32331705317550c31318635317050d32300303317050c3133175531755186352c7550c313003030d3232f7052f7550c313186252c7550c31318635287550c3131864525755186250d3031861500000
__music__
00 0a0e1744
00 0b0f1744
00 0c101744
00 0d111844
01 0a0e1644
00 0b0f1644
00 0c101644
00 0d111644
00 120e1644
00 130f1644
00 14101644
00 15111644
00 0a0e1644
00 0b0f1644
00 0c101644
00 0d111644
00 0a0e1944
00 0b0f1a44
00 0c101d44
02 0d111e44

